const scanSection=document.querySelector("section.scannen");let scanInterval,formats,cameraStatus=0;BarcodeDetector.getSupportedFormats().then(e=>formats=e);const barcodeDetector=new BarcodeDetector({formats:formats});function createVideo(){if(0==cameraStatus){const e=document.createElement("video");if(e.setAttribute("id","video"),e.autoplay=!0,scanSection.appendChild(e),scanSection.classList.add("enable"),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){const t={video:!0,audio:!1};navigator.mediaDevices.getUserMedia(t).then(t=>e.srcObject=t)}scanInterval=setInterval(scanProducts,3e3),cameraStatus=1}else{document.querySelector("#video").srcObject.getTracks().forEach(e=>e.stop()),scanSection.classList.remove("enable"),clearInterval(scanInterval),scanSection.innerHTML="",cameraStatus=0}}function scanProducts(){const e=document.querySelector("#video");barcodeDetector.detect(e).then(e=>{0==e.length?console.log("No barcode found..."):e.forEach(e=>{console.log(e.rawValue),document.querySelector("#video").srcObject.getTracks().forEach(e=>e.stop()),scanSection.classList.remove("enable"),clearInterval(scanInterval),scanSection.innerHTML="",cameraStatus=0,window.location.hash="#product/"+e.rawValue})}).catch(e=>{console.log(e)})}createVideo();